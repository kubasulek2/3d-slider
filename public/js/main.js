const _rotationSpeed=Symbol("rotationSpeed"),_clickedId=Symbol("clickedId"),_easing=Symbol("easing"),_speedMeasure=Symbol("speedMeasure"),_motionData=Symbol("motionData"),_dynamicContent=Symbol("dynamicContent");class htmlElement{constructor(t){this.element=t}copy(){return this.element.clone()}remove(){this.element.remove()}append(t){this.element.append(t)}}class slider3d extends htmlElement{constructor(t,e){super(t),this.baseSpeed=e>1?1:e,this.faces=this.element.children(".face"),this[_rotationSpeed]=e>1?1:e,this[_clickedId]="",this[_easing]=[],this[_speedMeasure]={start:void 0,stop:void 0,lastMeasuredAngle:void 0,speedArr:[],avgSpeed:void 0},this[_motionData]={isAboutToStop:!1,angleWhenClicked:void 0,currentAngle:0,targetAngle:void 0,move:!0},this[_dynamicContent]={content:1,willUpdate:!0}}calculateEntryValues(){this[_speedMeasure].avgSpeed=30/(60*this.baseSpeed)}animateElement(){if(this[_speedMeasure].avgSpeed||this.calculateEntryValues(),this[_motionData].move){let t=this.computeRotatingTime();this.computeAvgSpeed(t),this.updateContent(),0!==this[_easing].length&&this.applyEasing(),0===this[_easing].length&&this[_rotationSpeed]<this.baseSpeed&&this.accelerate(),this[_motionData].currentAngle-=this[_rotationSpeed],this[_motionData].currentAngle=this[_motionData].currentAngle<=-360?0:this[_motionData].currentAngle,this.element.css("transform",` translateZ(-250px) rotateY(${this[_motionData].currentAngle}deg)`),Math.round(this[_motionData].currentAngle)===this[_motionData].targetAngle&&(this[_motionData].move=!1,this.element.css("transform",` translateZ(-250px) rotateY(${this[_motionData].targetAngle}deg)`)),window.requestAnimationFrame(()=>this.animateElement())}else this.animatePlane()}computeRotatingTime(){let t,e=Math.abs(Math.floor(this[_motionData].currentAngle)),a=!(e%31);return this[_speedMeasure].lastMeasuredAngle===e?null:(this[_speedMeasure].lastMeasuredAngle=e,this[_speedMeasure].measureAngle===e?(this[_speedMeasure].stop=new Date,t=(this[_speedMeasure].stop-this[_speedMeasure].start)/1e3):(a&&(this[_speedMeasure].measureAngle=360===this[_motionData].currentAngle?30:e+30,this[_speedMeasure].start=new Date),null))}computeEasing(t){let e,a,n,i,s,o,r=Math.abs(Math.abs(this[_motionData].targetAngle)-Math.abs(this[_motionData].currentAngle)),h=r<20?5:10,l=[],c=this[_rotationSpeed];switch(!0){case r<=10:a=0;break;case r<=20:a=3;break;case r<=30:a=8;break;case r<=40:a=15;break;case r<=50:a=24;break;case r<=60:a=32;break;case r<=70:a=40;break;case r<=80:a=50;break;case r<=90:a=60}e=(r-a)/h,i=c/h,n=c,o=s="forth"===t?this[_motionData].currentAngle-a:this[_motionData].currentAngle+a,e="forth"===t?-e:e;for(let t=1;t<h;t++)o+=e,n=(n-=i)>0?n<.1?.1:n:n>-.1?-.1:n,l[t-1]=[],l[t-1].push(Math.round(o)),l[t-1].push(parseFloat(n.toFixed(2)));return l}applyEasing(){this[_easing].forEach(t=>{Math.round(this[_motionData].currentAngle)===t[0]&&(this[_rotationSpeed]=t[1])})}computeAvgSpeed(t){null!==t&&(this[_speedMeasure].speedArr.push(t),this[_speedMeasure].speedArr.length>4&&this[_speedMeasure].speedArr.shift(),this[_speedMeasure].avgSpeed=this[_speedMeasure].speedArr.reduce((t,e)=>t+e,0)/this[_speedMeasure].speedArr.length)}getTargetAngle(t){switch($(t.target).attr("id")){case"front":this[_motionData].targetAngle=0;break;case"right":this[_motionData].targetAngle=-90;break;case"back":this[_motionData].targetAngle=-180;break;case"left":this[_motionData].targetAngle=-270}}shouldChangeDirection(){let t="forth";return 0===this[_motionData].targetAngle?(this[_rotationSpeed]=this[_motionData].currentAngle<-180?this[_rotationSpeed]:-this[_rotationSpeed],t=this[_motionData].currentAngle<-180?"forth":"back"):this[_motionData].currentAngle<this[_motionData].targetAngle&&(this[_rotationSpeed]=-this[_rotationSpeed],t="back"),t}animatePlane(){this.faces.filter((t,e)=>$(e).attr("id")===this[_clickedId]).addClass("focus")}planeClickEvent(){this.faces.on("click",t=>{if(!this[_motionData].isAboutToStop){let e=$(t.currentTarget);t.stopPropagation(),this.getTargetAngle(t),this[_clickedId]=t.target.id;let a=this.shouldChangeDirection();this[_motionData].isAboutToStop=!0,this[_easing]=this.computeEasing(a),this[_motionData].angleWhenClicked=this[_motionData].currentAngle,e.css("cursor","initial"),$("body").css("cursor","pointer").one("click",t=>{this[_motionData].isAboutToStop=!1,e.css("cursor","pointer"),$(t.currentTarget).css("cursor","initial"),this.restoreAnimation()})}})}restoreAnimation(){let t=this.faces.filter((t,e)=>$(e).attr("id")===this[_clickedId]);t.removeClass("focus"),this[_easing]=[],this[_motionData].move=!0,this[_motionData].targetAngle=void 0,this[_clickedId]="",this[_rotationSpeed]=this[_rotationSpeed]<0?-this[_rotationSpeed]:this[_rotationSpeed],t.one("transitionend",()=>{this.animateElement()})}accelerate(){this[_rotationSpeed]=parseFloat((this[_rotationSpeed]+.005).toFixed(3))}updateContent(){this[_motionData].currentAngle<-10&&this[_motionData].currentAngle>-20&&this[_dynamicContent].willUpdate?(this[_dynamicContent].content=this[_rotationSpeed]>0?this[_dynamicContent].content+2:this[_dynamicContent].content,this[_dynamicContent].willUpdate=!1,$(this.faces[2]).text(`face ${this[_dynamicContent].content}`),$(this.faces[3]).text(`face ${this[_dynamicContent].content+1}`)):this[_motionData].currentAngle<-20&&this[_motionData].currentAngle>-30&&!this[_dynamicContent].willUpdate?this[_dynamicContent].willUpdate=!0:this[_motionData].currentAngle<-190&&this[_motionData].currentAngle>-200&&this[_dynamicContent].willUpdate?(this[_dynamicContent].content=this[_rotationSpeed]>0?this[_dynamicContent].content+2:this[_dynamicContent].content,this[_dynamicContent].willUpdate=!1,$(this.faces[0]).text(`face ${this[_dynamicContent].content}`),$(this.faces[1]).text(`face ${this[_dynamicContent].content+1}`)):this[_motionData].currentAngle<-200&&this[_motionData].currentAngle>-210&&!this[_dynamicContent].willUpdate&&(this[_dynamicContent].willUpdate=!0)}}let myElement=new slider3d($("#top-layer"),1);$(()=>{myElement.animateElement(),myElement.planeClickEvent()});
//# sourceMappingURL=main.js.map
